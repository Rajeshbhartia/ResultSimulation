{"version":3,"sources":["MakeColumns.js","FIleInput.js","PdfGeneratorInterface.js","App.js","index.js"],"names":["make_cols","refstr","o","C","XLSX","utils","decode_range","e","c","i","name","encode_col","key","FileInput","props","state","file","data","cols","handleFile","bind","handleChange","files","target","this","setState","reader","FileReader","rABS","readAsBinaryString","onload","bstr","result","wb","read","type","bookVBA","wsname","SheetNames","ws","Sheets","sheet_to_json","getData","readAsArrayBuffer","htmlFor","className","id","accept","onChange","value","onClick","Component","PDFGeneratorInterface","tableHeaderArr","tableBodyArr","currentActiveObject","_getJsPdfInstance","jsPDF","downloadTableAsPDF","_makePDF","_pdf","save","_makeHeaderSection","_makeMetaDataSection","_makeTableDataSection","text","autoTable","startY","headStyles","lineWidth","lineColor","styles","cellWidth","cellPadding","didParseCell","table","section","cell","fillColor","textColor","_currentActiveObject","theme","head","_makeHeaderRow","body","_makeBodyRows","fontSize","tableWidth","_tableHeaderArr","reduce","obj","headerName","index","subsetPropNames","Set","_tableBodyArr","map","realObj","clonedRealObj","_pluckSubset","subsetObj","p","App","tableHeadersArr","tableRowsArr","isBtnDis","forEach","item","Marks","grade","Object","keys","generatePDF","PdfGeneratorInterface","style","display","alignItems","justifyContent","background","minHeight","flexDirection","padding","Button","variant","color","disabled","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.8baa2fdd.chunk.js","sourcesContent":["import XLSX from 'xlsx';\r\n/* generate an array of column objects */\r\nexport const make_cols = refstr => {\r\n\tlet o = [], C = XLSX.utils.decode_range(refstr).e.c + 1;\r\n\tfor(var i = 0; i < C; ++i) o[i] = {name:XLSX.utils.encode_col(i), key:i}\r\n\treturn o;\r\n};","import React, { Component } from 'react';\r\nimport XLSX from 'xlsx';\r\nimport { make_cols } from './MakeColumns';\r\n\r\n\r\nclass FileInput extends Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            file: {},\r\n            data: [],\r\n            cols: []\r\n        }\r\n        this.handleFile = this.handleFile.bind(this);\r\n        this.handleChange = this.handleChange.bind(this);\r\n    }\r\n\r\n    handleChange(e) {\r\n        const files = e.target.files;\r\n        if (files && files[0]) this.setState({ file: files[0] });\r\n    };\r\n\r\n    handleFile() {\r\n        /* Boilerplate to set up FileReader */\r\n        const reader = new FileReader();\r\n        const rABS = !!reader.readAsBinaryString;\r\n\r\n        reader.onload = (e) => {\r\n            /* Parse data */\r\n            const bstr = e.target.result;\r\n            const wb = XLSX.read(bstr, { type: rABS ? 'binary' : 'array', bookVBA: true });\r\n            /* Get first worksheet */\r\n            const wsname = wb.SheetNames[0];\r\n            const ws = wb.Sheets[wsname];\r\n            /* Convert array of arrays */\r\n            const data = XLSX.utils.sheet_to_json(ws);\r\n            /* Update state */\r\n            this.setState({ data: data, cols: make_cols(ws['!ref']) }, () => {\r\n                // console.log((this.state.data));\r\n                this.props.getData(this.state.data)\r\n            });\r\n\r\n        };\r\n\r\n        if (rABS) {\r\n            reader.readAsBinaryString(this.state.file);\r\n        } else {\r\n            reader.readAsArrayBuffer(this.state.file);\r\n        };\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div>\r\n                <label htmlFor=\"file\">Upload an excel to Process Triggers</label>\r\n                <br />\r\n                <input type=\"file\" className=\"form-control\" id=\"file\" accept={\".xls,.xlsx\"} onChange={this.handleChange} />\r\n                <br />\r\n                <input type='submit'\r\n                    value=\"Submit File\"\r\n                    onClick={this.handleFile} />\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\nexport default FileInput;","/**\r\n * Author: Al-Zami Rahman, last modified: 25-11-2019\r\n * Description: Class component for generating pdf for crudview\r\n */\r\n\r\n \r\nimport jsPDF from \"jspdf\";\r\nimport \"jspdf-autotable\";\r\n// const base64Img = \"data:image/png;base64,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\"\r\n\r\nclass PDFGeneratorInterface {\r\n    constructor(tableHeaderArr, tableBodyArr,currentActiveObject) {\r\n         this._pdf = this._getJsPdfInstance ()\r\n         this._tableHeaderArr = tableHeaderArr\r\n         this._tableBodyArr = tableBodyArr\r\n         this._currentActiveObject = currentActiveObject\r\n    }\r\n\r\n    _getJsPdfInstance = () => {\r\n        return new jsPDF();\r\n    }\r\n\r\n    downloadTableAsPDF = () => {\r\n        this._makePDF()\r\n        this._pdf.save(\"a4.pdf\");\r\n    }\r\n\r\n    _makePDF = () => {\r\n        this._makeHeaderSection()\r\n        this._makeMetaDataSection()\r\n        this._makeTableDataSection()\r\n    }\r\n\r\n    _makeHeaderSection = () => {\r\n        this._pdf.text(\"Pathshala\", 100, 10, \"center\");\r\n        // this._pdf.addImage(base64Img, \"jpg\", 73, 5, 8, 8);\r\n    }\r\n\r\n    _makeMetaDataSection = () => {\r\n        this._pdf.autoTable({\r\n            startY: 23,\r\n            // theme: \"\",\r\n            //html: '#printable',\r\n            //head: headRows(),\r\n            // body: [\r\n            //   [\"Name :\", \"Mr.X\"],\r\n            //   [\"Email :\", \"valid@gmail.com\"],\r\n            //   [\"Generate Date :\", \"12-10-3019\"]\r\n            // ],\r\n            headStyles: {\r\n              lineWidth: 0.1,\r\n              lineColor: [0, 0, 0]\r\n            },\r\n            styles: {\r\n              cellWidth: 35,\r\n              cellPadding: 0.7\r\n              //rowHeight :0\r\n            },\r\n            didParseCell: function(table) {\r\n              if (table.section === \"head\") {\r\n                table.cell.styles.fillColor = \"white\";\r\n                table.cell.styles.textColor = \"black\";\r\n                table.cell.styles.lineColor = \"black\";\r\n              }\r\n              if (table.section === \"body\") {\r\n                table.cell.styles.fillColor = \"white\";\r\n                table.cell.styles.textColor = \"black\";\r\n                table.cell.styles.lineColor = \"black\";\r\n              }\r\n            }\r\n        });\r\n    }\r\n\r\n    _makeTableDataSection = () => {\r\n        this._pdf.text(this._currentActiveObject, 100, 55, \"center\");\r\n        this._pdf.autoTable({\r\n          startY: 60,\r\n          // margin: {top: 10},\r\n          theme: \"grid\",\r\n          //html: '#printable',\r\n          head: this._makeHeaderRow(),\r\n          body: this._makeBodyRows(),\r\n          headStyles: {\r\n            lineWidth: 0.1,\r\n            lineColor: [0, 0, 0]\r\n          },\r\n          styles: {\r\n            cellPadding: 0.5,\r\n            fontSize : 9,\r\n            tableWidth: 'wrap',\r\n          },\r\n          didParseCell: function(table) {\r\n            if (table.section === \"head\") {\r\n              table.cell.styles.fillColor = \"white\";\r\n              table.cell.styles.textColor = \"black\";\r\n              table.cell.styles.lineColor = \"black\";\r\n            }\r\n            if (table.section === \"body\") {\r\n              table.cell.styles.fillColor = \"white\";\r\n              table.cell.styles.textColor = \"black\";\r\n              table.cell.styles.lineColor = \"black\";\r\n            }\r\n          }\r\n        });\r\n    }\r\n\r\n    _makeHeaderRow = () => {\r\n        let headersObj = this._tableHeaderArr.reduce((obj,headerName,index)=>{\r\n            obj[headerName] = headerName\r\n            return obj\r\n        },{})\r\n        return [headersObj];\r\n    }\r\n\r\n    _makeBodyRows = () => {\r\n        let subsetPropNames = new Set(this._tableHeaderArr)\r\n        let body = this._tableBodyArr.map(realObj=>{\r\n            let clonedRealObj = {...realObj}\r\n            let subsetObj = this._pluckSubset(clonedRealObj,subsetPropNames)\r\n            // console.log(subsetObj) \r\n            return subsetObj\r\n        })\r\n        return body;\r\n    }\r\n\r\n    _pluckSubset = (clonedRealObj, subsetPropNames) => {\r\n        let subsetObj = {}\r\n        for(let p of subsetPropNames) {\r\n            subsetObj[p] = clonedRealObj[p]\r\n        }\r\n        return subsetObj\r\n    }\r\n}\r\n\r\nexport default PDFGeneratorInterface;","import React, { Component } from 'react';\nimport FileInput from './FIleInput';\nimport PdfGeneratorInterface from \"./PdfGeneratorInterface\";\nimport { Button } from '@material-ui/core';\n\nclass App extends Component {\n\n  state = {\n    tableHeadersArr: [],\n    tableRowsArr: [],\n    isBtnDis: true\n  }\n\n  getData = (data) => {\n\n    data.forEach((item, i) => {\n      switch (true) {\n        case (item.Marks < 40):\n          item.grade = \"fail\"\n          break;\n        case (item.Marks < 50):\n          item.grade = \"D\"\n          break;\n        case (item.Marks < 60):\n          item.grade = \"C\"\n          break;\n        case (item.Marks < 70):\n          item.grade = \"B\"\n          break;\n        case (item.Marks < 80):\n          item.grade = \"A\"\n          break;\n        default:\n          item.grade = \"A+\"\n          break;\n      }\n    })\n\n\n    this.setState({\n      tableHeadersArr: Object.keys(data[0]),\n      tableRowsArr: data,\n      isBtnDis: false\n    })\n  }\n\n  generatePDF = () => {\n    let pdfInterface = new PdfGeneratorInterface(\n      this.state.tableHeadersArr,\n      this.state.tableRowsArr,\n      \"Result\"\n    );\n    pdfInterface.downloadTableAsPDF();\n  };\n\n  render() {\n    return (\n      <div style={{ display: \"flex\", alignItems: \"center\", justifyContent: \"center\", background: \"#ededed\", minHeight: \"100vh\", flexDirection: \"column\" }}>\n        <div style={{ padding: \"20px\" }}>\n\n          <FileInput getData={this.getData} />\n        </div>\n        <Button\n          variant=\"contained\"\n          color=\"primary\"\n          disabled={this.state.isBtnDis}\n          onClick={this.generatePDF}\n        >\n          Download Result\n        </Button>\n      </div>\n    );\n  }\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(\n    <App />,\n  document.getElementById('root')\n);"],"sourceRoot":""}